2025-11-02 19:05:50 - INFO - Pipeline run initialised with Job ID: b981df96
2025-11-02 19:05:50 - INFO - ==================================================
2025-11-02 19:05:50 - INFO - ONLINE RETAIL DATA PIPELINE - STARTING
2025-11-02 19:05:50 - INFO - ==================================================
2025-11-02 19:05:50 - INFO - ==================================================
2025-11-02 19:05:50 - INFO - STEP 1: DATA INGESTION
2025-11-02 19:05:50 - INFO - ==================================================
2025-11-02 19:05:52 - INFO - ==================================================
2025-11-02 19:05:52 - INFO - DATA INGESTION PROCESS
2025-11-02 19:05:52 - INFO - ==================================================
2025-11-02 19:05:52 - INFO - Initiated data ingestion...
2025-11-02 19:05:52 - INFO - Attempting UCI ML Repo API...
2025-11-02 19:06:15 - INFO - UCI API successful: 541,909 rows, 8 columns
2025-11-02 19:06:17 - INFO - Raw data saved: data/raw/Online_Retail_raw_20251102_190615.csv
2025-11-02 19:06:17 - INFO - ✓ Data ingestion completed successfully
2025-11-02 19:06:17 - INFO - ==================================================
2025-11-02 19:06:17 - INFO - STEP 2: DATA PROFILING
2025-11-02 19:06:17 - INFO - ==================================================
2025-11-02 19:06:17 - INFO - Generating data quality metrics...
2025-11-02 19:06:17 - INFO - Generating data quality summary...
2025-11-02 19:06:18 - INFO - ✓ Updated profiling history with comprehensive metrics for job: b981df96
2025-11-02 19:06:18 - INFO - ==================================================
2025-11-02 19:06:18 - INFO - DATA QUALITY ASSESSMENT REPORT
2025-11-02 19:06:18 - INFO - ==================================================
2025-11-02 19:06:18 - INFO - Dataset Overview:
2025-11-02 19:06:18 - INFO -   Rows: 541,909
2025-11-02 19:06:18 - INFO -   Columns: 8
2025-11-02 19:06:18 - INFO -   Completeness: 96.85%
2025-11-02 19:06:18 - INFO - Key Data Quality Issues:
2025-11-02 19:06:18 - INFO -   Missing CustomerIDs: 135,080
2025-11-02 19:06:18 - INFO -   Duplicate Rows: 5,268
2025-11-02 19:06:18 - INFO -   Invalid Prices: 2,517
2025-11-02 19:06:18 - INFO - Business Constraints Identified: 6
2025-11-02 19:06:18 - INFO - ✓ Data profiling completed successfully
2025-11-02 19:06:18 - INFO - ==================================================
2025-11-02 19:06:18 - INFO - STEP 3: DATA CLEANING & TRANSFORMATION
2025-11-02 19:06:18 - INFO - ==================================================
2025-11-02 19:06:18 - INFO - Starting data cleaning process...
2025-11-02 19:06:18 - INFO - Converting InvoiceDate to datetime...
2025-11-02 19:06:18 - INFO - Adding cancellation flags...
2025-11-02 19:06:19 - INFO -   Found 9,288 cancelled transactions
2025-11-02 19:06:19 - INFO - Handling missing CustomerIDs...
2025-11-02 19:06:19 - INFO -   Found 135,080 records with missing CustomerID
2025-11-02 19:06:19 - INFO - Handling missing descriptions...
2025-11-02 19:06:19 - INFO -   Found 1,454 missing descriptions
2025-11-02 19:06:19 - INFO - Removing duplicates...
2025-11-02 19:06:19 - INFO -   Removed 5,268 duplicate rows
2025-11-02 19:06:19 - INFO - Filtering invalid prices...
2025-11-02 19:06:19 - INFO -   Found 2,512 records with invalid prices
2025-11-02 19:06:19 - INFO -   Excluded 2,512 records
2025-11-02 19:06:19 - INFO - Calculating line totals...
2025-11-02 19:06:19 - INFO - Adding data quality flags...
2025-11-02 19:06:19 - INFO -   Flagged 4 high-quantity records for review
2025-11-02 19:06:19 - INFO - Extracting date components...
2025-11-02 19:06:19 - INFO - Standardising country names...
2025-11-02 19:06:20 - INFO - Data cleaning completed successfully
2025-11-02 19:06:20 - INFO - Initial rows: 541,909
2025-11-02 19:06:20 - INFO - Final rows: 534,129
2025-11-02 19:06:20 - INFO - Pass rate: 98.56%
2025-11-02 19:06:24 - INFO - ✓ Cleaned data saved: data/processed/cleaned_data_20251102_1906.csv
2025-11-02 19:06:24 - INFO - ==================================================
2025-11-02 19:06:24 - INFO - STEP 4: DATA MODELING
2025-11-02 19:06:24 - INFO - ==================================================
2025-11-02 19:06:24 - INFO - Creating dimensional star schema...
2025-11-02 19:06:24 - INFO - Creating dim_date...
2025-11-02 19:06:24 - INFO -   Created 374 date records
2025-11-02 19:06:24 - INFO - Creating dim_product...
2025-11-02 19:06:24 - INFO -   Created 3,938 product records
2025-11-02 19:06:24 - INFO - Creating dim_customer...
2025-11-02 19:06:24 - INFO -   Created 4,372 customer records
2025-11-02 19:06:24 - INFO - Creating fact_sales...
2025-11-02 19:06:27 - INFO -   Created 534,129 transaction records
2025-11-02 19:06:27 - INFO - Ensuring correct data types...
2025-11-02 19:06:27 - INFO -   Data types ensured
2025-11-02 19:06:27 - INFO - Modeling completed successfully
2025-11-02 19:06:27 - INFO -   dim_date: 374 rows
2025-11-02 19:06:27 - INFO -   dim_product: 3,938 rows
2025-11-02 19:06:27 - INFO -   dim_customer: 4,372 rows
2025-11-02 19:06:27 - INFO -   fact_sales: 534,129 rows
2025-11-02 19:06:27 - INFO - Saving dimensional model as parquet files...
2025-11-02 19:06:28 - ERROR - Pipeline failed: Cannot save file into a non-existent directory: 'data/model/dim_date'
